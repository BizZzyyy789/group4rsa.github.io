// document.getElementById('f18').style.visibility = 'hidden';
// document.getElementById('f168').style.visibility = 'hidden';
// document.getElementById('F9').style.visibility = 'hidden';
// document.getElementById('F99').style.visibility = 'hidden';
// document.getElementById('F12').style.visibility = 'hidden';
// document.getElementById('F13').style.visibility = 'hidden';
// document.getElementById('F17').style.visibility = 'hidden';
document.getElementById('F8').style.visibility = 'hidden';
document.getElementById('key').style.visibility = 'hidden';
// document.getElementById('f20').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
// document.getElementById('n').style.visibility = 'hidden';
// document.getElementById('d').style.visibility = 'hidden';
// document.getElementById('t').style.visibility = 'hidden';
// document.getElementById('e').style.visibility = 'hidden';
// document.getElementById('private').style.visibility = 'hidden';
// document.getElementById('public').style.visibility = 'hidden';
// document.getElementById('encrytion').style.visibility = 'hidden';
document.getElementById('encrytion_click').style.visibility = 'hidden';
document.getElementById('encrytion_value').style.visibility = 'hidden';
document.getElementById('encrytion_result').style.visibility = 'hidden';
document.getElementById('switch').style.visibility = 'hidden';
document.querySelector('.F7').style.visibility = 'hidden';
document.getElementById('Decrytion_click').style.visibility = 'hidden';
document.getElementById('Decrytion_value').style.visibility = 'hidden';
document.getElementById('Decrytion_result').style.visibility = 'hidden';
document.getElementById('before_result').style.visibility = 'hidden';
document.getElementById('switchh').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
document.getElementById('F21').style.visibility = 'hidden';
document.getElementById('F22').style.visibility = 'hidden';
document.querySelector('#F2').style.visibility = 'visible';
document.querySelector('#F3').style.visibility = 'visible';
document.querySelector('#F40').style.visibility = 'visible';
document.querySelector('#connection').style.visibility = 'visible';
document.querySelector('.img').style.visibility = 'visible';
document.getElementById('connection').onclick = function connectionn()
{
	// document.querySelector('#encrytion').style.visibility = 'visible';
	document.querySelector('#encrytion_click').style.visibility = 'visible';
	document.querySelector('#encrytion_value').style.visibility = 'visible';
	document.querySelector('#encrytion_result').style.visibility = 'visible';
	document.querySelector('#switch').style.visibility = 'visible';
	document.querySelector('.F7').style.visibility = 'visible';
	document.querySelector('#F2').style.visibility = 'hidden';
	document.querySelector('#F3').style.visibility = 'hidden';
	document.querySelector('#F40').style.visibility = 'hidden';
	document.querySelector('#connection').style.visibility = 'hidden';
	document.querySelector('.img').style.visibility = 'hidden';
	document.getElementById('F8').style.visibility = 'visible';
	document.getElementById('before_result').style.visibility = 'visible';
	


}
document.getElementById('switch').onclick = function connectionn()
{
	document.querySelector('.F7').style.visibility = 'visible';	
	document.getElementById('F19').style.visibility = 'hidden';
	document.getElementById('key').style.visibility = 'hidden';
	document.getElementById('encrytion_click').style.visibility = 'hidden';
	document.getElementById('encrytion_value').style.visibility = 'hidden';
	document.getElementById('encrytion_result').style.visibility = 'hidden';
	document.getElementById('switch').style.visibility = 'hidden';
	document.getElementById('Decrytion_click').style.visibility = 'visible';
	document.getElementById('Decrytion_value').style.visibility = 'visible';
	document.getElementById('Decrytion_result').style.visibility = 'visible';
	document.getElementById('switchh').style.visibility = 'visible'; 
	document.querySelector('#F2').style.visibility = 'hidden';
	document.querySelector('#F3').style.visibility = 'hidden';
	document.querySelector('#F40').style.visibility = 'hidden';
	document.querySelector('#connection').style.visibility = 'hidden';
	document.querySelector('.img').style.visibility = 'hidden';
	document.getElementById('before_result').style.visibility = 'hidden';
	document.getElementById('Decrytion_value').value = " ";
	reset.style.filter = "blur(0px)";
}
document.getElementById('switchh').onclick = function connectionn()
{
	document.querySelector('.F7').style.visibility = 'visible';
	document.getElementById('key').style.visibility = 'visible';
	document.getElementById('encrytion_click').style.visibility = 'visible';
	document.getElementById('encrytion_value').style.visibility = 'visible';
	document.getElementById('encrytion_result').style.visibility = 'visible';
	document.getElementById('switch').style.visibility = 'visible';
	document.getElementById('Decrytion_click').style.visibility = 'hidden';
	document.getElementById('Decrytion_value').style.visibility = 'hidden';
	document.getElementById('Decrytion_result').style.visibility = 'hidden';
	document.getElementById('switchh').style.visibility = 'hidden';
	document.querySelector('#F2').style.visibility = 'hidden';
	document.querySelector('#F3').style.visibility = 'hidden';
	document.querySelector('#F40').style.visibility = 'hidden';
	document.querySelector('#connection').style.visibility = 'hidden';
	document.querySelector('.img').style.visibility = 'hidden';
	document.getElementById('before_result').style.visibility = 'visible';
	document.getElementById('encrytion_value').value = " ";
	testt.style.filter = "blur(0px)";
	
}
document.getElementById('F17').onclick = function connectionn()
{
document.getElementById('encrytion_click').style.visibility = 'hidden';
document.getElementById('F8').style.visibility = 'hidden';
document.getElementById('key').style.visibility = 'hidden';
document.getElementById('encrytion_value').style.visibility = 'hidden';
document.getElementById('encrytion_result').style.visibility = 'hidden';
document.getElementById('switch').style.visibility = 'hidden';
document.querySelector('.F7').style.visibility = 'hidden';
document.getElementById('Decrytion_click').style.visibility = 'hidden';
document.getElementById('Decrytion_value').style.visibility = 'hidden';
document.getElementById('Decrytion_result').style.visibility = 'hidden';
document.getElementById('switchh').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
document.getElementById('F21').style.visibility = 'hidden';
document.getElementById('F22').style.visibility = 'hidden';
document.querySelector('#F2').style.visibility = 'visible';
document.querySelector('#F3').style.visibility = 'visible';
document.querySelector('#F40').style.visibility = 'visible';
document.querySelector('#connection').style.visibility = 'visible';
document.querySelector('.img').style.visibility = 'visible';
document.getElementById('before_result').style.visibility = 'hidden';
}

document.getElementById('F19').onclick = function connectionn()
{
document.getElementById('encrytion_click').style.visibility = 'hidden';
document.getElementById('encrytion_value').style.visibility = 'hidden';
document.getElementById('F8').style.visibility = 'hidden';
document.getElementById('encrytion_result').style.visibility = 'hidden';
document.getElementById('switch').style.visibility = 'hidden';
document.querySelector('.F7').style.visibility = 'hidden';
document.getElementById('Decrytion_click').style.visibility = 'hidden';
document.getElementById('Decrytion_value').style.visibility = 'hidden';
document.getElementById('Decrytion_result').style.visibility = 'hidden';
document.getElementById('switchh').style.visibility = 'hidden';
document.getElementById('key').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
document.getElementById('F21').style.visibility = 'hidden';
document.getElementById('F22').style.visibility = 'hidden';
document.getElementById('before_result').style.visibility = 'hidden';
document.querySelector('#F2').style.visibility = 'visible';
document.querySelector('#F3').style.visibility = 'visible';
document.querySelector('#F40').style.visibility = 'visible';
document.querySelector('#connection').style.visibility = 'visible';
document.querySelector('.img').style.visibility = 'visible';
}
document.getElementById('F21').onclick = function connectionn()
{
document.getElementById('encrytion_click').style.visibility = 'hidden';
document.getElementById('encrytion_value').style.visibility = 'hidden';
document.getElementById('encrytion_result').style.visibility = 'hidden';
document.getElementById('switch').style.visibility = 'hidden';
document.querySelector('.F7').style.visibility = 'hidden';
document.getElementById('F8').style.visibility = 'hidden';
document.getElementById('Decrytion_click').style.visibility = 'hidden';
document.getElementById('Decrytion_value').style.visibility = 'hidden';
document.getElementById('Decrytion_result').style.visibility = 'hidden';
document.getElementById('switchh').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
document.getElementById('F21').style.visibility = 'hidden';
document.getElementById('F22').style.visibility = 'hidden';
document.querySelector('#F2').style.visibility = 'visible';
document.getElementById('key').style.visibility = 'hidden';
document.querySelector('#F3').style.visibility = 'visible';
document.querySelector('#F40').style.visibility = 'visible';
document.querySelector('#connection').style.visibility = 'visible';
document.getElementById('before_result').style.visibility = 'hidden';
document.querySelector('.img').style.visibility = 'visible';
}
document.getElementById('F22').onclick = function connectionn()
{
document.getElementById('encrytion_click').style.visibility = 'hidden';
document.getElementById('encrytion_value').style.visibility = 'hidden';
document.getElementById('encrytion_result').style.visibility = 'hidden';
document.getElementById('switch').style.visibility = 'hidden';
document.querySelector('.F7').style.visibility = 'hidden';
document.getElementById('F8').style.visibility = 'hidden';
document.getElementById('Decrytion_click').style.visibility = 'hidden';
document.getElementById('Decrytion_value').style.visibility = 'hidden';
document.getElementById('Decrytion_result').style.visibility = 'hidden';
document.getElementById('switchh').style.visibility = 'hidden';
document.getElementById('F19').style.visibility = 'hidden';
document.getElementById('F21').style.visibility = 'hidden';
document.getElementById('F22').style.visibility = 'hidden';
document.querySelector('#F2').style.visibility = 'visible';
document.querySelector('#F3').style.visibility = 'visible';
document.querySelector('#F40').style.visibility = 'visible';
document.querySelector('#connection').style.visibility = 'visible';
document.getElementById('key').style.visibility = 'hidden';
document.querySelector('.img').style.visibility = 'visible';
document.getElementById('before_result').style.visibility = 'hidden';
}
document.getElementById("encrytion_click").addEventListener("click", calculate);
document.getElementById("encrytion_click").addEventListener("click", resultt);
document.getElementById('key').addEventListener('click', decryptorChanged);
// RSA
"use strict";
let e, d, n, l,k;
var encrypted;
const ciphertextt = [];
const plaintext = document.getElementById('encrytion_value').value;
function letterToNumber(letter) {
    const charCode = letter.toUpperCase().charCodeAt(0) - 'A'.charCodeAt(0);
    return charCode >= 0 && charCode < 26 ? charCode : -1;
}
function numberToLetter(number) {
    return String.fromCharCode(((number - 1 + 26) % 26) + 'A'.charCodeAt(0));
}
function validatePrime(prime, nameOfPrime) {
	if(!isPrime(prime)) 
	{
		alert("'" + nameOfPrime + "' is not a prime number. Please enter a prime number.");
		
		return;
	}
	return true;
}
function modInverse(a, m) {
    var m0 = m;
    var x0 = 0;
    var x1 = 1;
    if (m === 1) return 0;
    while (a > 1) {
        var q = Math.floor(a / m);
        var temp = m;
        m = a % m;
        a = temp;
        temp = x0;
        x0 = x1 - q * x0;
        x1 = temp;
    }
    if (x1 < 0) x1 += m0;
    return x1;
}
let prime_number;
let prime_numberr;
	let number = 157;
	let numberr = 149;
	isPrime(number);
	isPrime(numberr);
	prime_number = parseInt(number);
	prime_numberr = parseInt(numberr);
function calculate() 
{      
	let  p;
    let  q;
	p = prime_number;
	q = prime_numberr;
    n = p * q;
    l = (p - 1) * (q - 1);
    var es = findEncryptionKeys(l, n);
    e = es[0]; 
	d = modInverse(e, l);
    encryptorChanged();
	encrypt();
}
function encryptorChanged()
 {   
	d =modInverse(e, l);	
}
function decryptorChanged() {
	let check = document.getElementById('encrytion_value').value;
	d = Math.floor(Math.random()*10000+1);
	if(check <0)
	{
		alert("Please Check Your Private Key : ");
		return;
	}
	else
	{	 
	   alert("Your Private key : "+ d + "\n" + "PLease Keep it private..!");
	}
}
function isPrime(num) {
	for (let i = 2, s = Math.sqrt(num); i <= s; i++)
		if (num % i === 0) return false;
	return num !== 1;
}
function findEncryptionKeys(l, n) {
	var arr = [];
	for(var i = 2; i < l; i++) {
		if(isCoPrime(i, l) && isCoPrime(i, n))
			arr.push(i);
			if(arr.length > 5) break;
	}     
	return arr;
}
function isCoPrime(a, b) {            
	var aFac = findFactors(a);
	var bFac = findFactors(b);
	var result = aFac.every(x => bFac.indexOf(x) < 0);
	return result;
}
var hashtable = new Object();
function findFactors(num) {
	if(hashtable[num])
		return hashtable[num];
	   var half = Math.floor(num / 2), 
		result = [],
		i, j;
	num % 2 === 0 ? (i = 2, j = 1) : (i = 3, j = 2);
	for (i; i <= half; i += j) {
		num % i === 0 ? result.push(i) : false;
	}
	result.push(num); 
	hashtable[num] = result;
	return result;
}
function findDecryptionKeys(e, l) {
	var ds = [];
	for(var x = l + 1;x < l + 100000; x++) {
		if(x * e % l === 1) {
			ds.push(x);
			if(ds.length > 5)   return ds;
		}
	}     
	return ds;
}
function encrypt() {
    const plaintext = document.getElementById('encrytion_value').value.toUpperCase();
    const ciphertext = [];
    for (let i = 0; i < plaintext.length; i++) {
        const numerical = letterToNumber(plaintext[i]);
        const encryptedValue = powerMod(numerical, e, n);
        ciphertext.push(encryptedValue);
    }

    return ciphertext.join(' ').padStart(4,"6");
}
function before()
{
	const plaintext = document.getElementById('encrytion_value').value.toUpperCase();
	for (let i = 0; i < plaintext.length; i++) 
	{
		const result_before = letterToNumber(plaintext[i]);
		ciphertextt.push(result_before);
    }
	return ciphertextt;
}
let reset = document.getElementById('encrytion_value');
function resultt() 
{
	const result_beforee = before();
	const plaintextext= document.getElementById('encrytion_value').value.toUpperCase();
    const encryptedText = encrypt();
	reset.style.filter = "blur(4px)";
	document.getElementById('key').style.visibility = 'visible';
    document.getElementById('encrytion_result').textContent = `Encrytion { ${plaintextext} } = ${encryptedText}`;
	document.getElementById('before_result').textContent ="Alphabet_number = "+ result_beforee;
	
}
function powerMod(base, exponent, modulus) {
    if (modulus === 1) return 0;
    let result = 1;
    base = base % modulus;
    while (exponent > 0) {
        if (exponent % 2 === 1)
            result = (result * base) % modulus;
        exponent = Math.floor(exponent / 2);
        base = (base * base) % modulus;
    }
    return result;
}
let testt = document.getElementById('Decrytion_value'); 
document.getElementById('Decrytion_click').onclick = function Decryptional()
{
	let encry =  document.getElementById("encrytion_value").value;
	let test = document.getElementById('Decrytion_value').value;
	
		if(parseInt(test) == parseInt(d))
		{
			document.getElementById('Decrytion_result').innerHTML = `The value are decryption is : ${encry}`;
			testt.style.filter = "blur(4px)";
		}
		else
		{
			alert("PLease Check Your NUmber Again.....!");
			return;
		}

}
